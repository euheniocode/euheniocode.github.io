<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Сайт Папы и Ярика">
  <meta name="author" content="Сайт Папы и Ярика">
  <meta name="yandex-verification" content="485bb6518eba9d7d" />
  <title>Отец и сын - друзья навсегда</title>
  <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/pricing/">
  <!-- Bootstrap core CSS -->
  <link href="dist/css/bootstrap.css" rel="stylesheet"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <!-- Favicons
<link rel="apple-touch-icon" href="https://getbootstrap.com/docs/4.5/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="https://getbootstrap.com/docs/4.5/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="https://getbootstrap.com/docs/4.5/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="https://getbootstrap.com/docs/4.5/assets/img/favicons/manifest.json">
<link rel="mask-icon" href="https://getbootstrap.com/docs/4.5/assets/img/favicons/safari-pinned-tab.svg" color="#563d7c">
-->
  <link rel="icon" href="favicon.ico">
  <meta name="msapplication-config" content="/docs/4.5/assets/img/favicons/browserconfig.xml">
  <meta name="theme-color" content="#563d7c">
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
  <link rel="stylesheet" href="style.css">
  <!-- Custom styles for this template -->
  <link href="dist/css/pricing.css" rel="stylesheet">
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
    integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
</head>

<body>
  <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
    <h5 class="my-0 mr-md-auto font-weight-normal"><a href="index.html"><b>
          <font color="red">Сайт</font> Папы и Ярика
        </b></a></h5>
    <nav class="my-2 my-md-0 mr-md-3">
      <!--<a class="btn btn-outline-success" href="javascript: void(0)" onclick="autocall();">Позвонить папе</a>-->
      <a id="btn_video2" class="btn btn-success" href="/peer/index.html?start=1"><i class="fas fa-video"></i>
        </a>

    </nav>
  </div>






  <h4>
    <div id="sendResult" class="alert alert-light"></div>
  </h4>



  <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">

    <div class="card">
      <div class="card-body">

        <div class="form-row align-items-center">
          <div class="col-12">
            <div class="input-group mb-2">
              <input type="text" class="form-control" id="sendText" placeholder="Напиши папе сообщение">
              <div class="input-group-prepend">
                <button type="submit" onclick="sendMessage();" class="btn btn-success mb-2"><i
                    class="fab fa-telegram-plane"></i></button>
              </div>
            </div>

          </div>

        </div>

      </div>
    </div>
  </div>

  <div class="game" onclick="gameStart();">
    <div id="dino"></div>
    <div id="cactus"></div>
  </div>
  <center>
    <div id="dino_info"></div>
  </center>
  <script src="script.js"></script>
  <center>
  <div class="container">
    <h1>
      <a id="btn_video" class="btn btn-success" href="peer/index.html?start=1"><i class="fas fa-video"></i>
        Видеозвонок</a>
    </h1>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .carousel-container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .carousel {
            display: flex;
            transition: transform 0.5s ease-in-out;
            height: 500px;
        }
        
        .carousel img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            flex-shrink: 0;
        }
        
        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.7);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s;
        }
        
        .carousel-btn:hover {
            background: white;
        }
        
        .prev {
            left: 15px;
        }
        
        .next {
            right: 15px;
        }
        
        .carousel-dots {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .dot.active {
            background: white;
            transform: scale(1.2);
        }
        
        .image-counter {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 10;
        }
    </style>
    
    <div class="carousel-container">
        <div class="carousel"></div>
        <button class="carousel-btn prev"><i class="fas fa-chevron-left"></i></button>
        <button class="carousel-btn next"><i class="fas fa-chevron-right"></i></button>
        <div class="carousel-dots"></div>
        <div class="image-counter"></div>
    </div>

    <script src="carousel.js"></script>
  </center>
    <script>
      var answ_text = '';
      var receive_messages_flag = 0;
      
      function incMessage() {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "https://script.google.com/macros/s/AKfycbwcdpt9gnOqL1utSzX4OXgeidrL-YOFZf6l-eSBnGmQXf4YOo98Q3JgK5x_OGHKMBsc/exec", true);
        xhr.onload = (e) => {
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              //console.log(xhr.responseText);
              answ = JSON.parse(xhr.responseText);
              let unix_ts = new Date(answ.result[0].message.date * 1000);
              var months = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'];
              let year = unix_ts.getFullYear();
              let month = months[unix_ts.getMonth()];;
              let date = unix_ts.getDate();
              let hour = unix_ts.getHours();
              let min = unix_ts.getMinutes();
              let dt = date + ' ' + month + ' ' + year + 'г. в ' + hour + ':' + min;
              if (answ_text != answ.result[0].message.text && answ.result[0].message.chat.id == 144265145) {
                answ_text = answ.result[0].message.text;
                // вывести результат
                document.getElementById('sendResult').innerHTML += '<p><span class="badge badge-primary badge-pill">От папы <span class="badge badge-light badge-pill">' + dt + '</span> <span class="badge badge-light badge-pill"><i class="fas fa-check"></i></span></span> <span class="badge badge-light badge-pill">' + answ_text + '</span></p>';

              }
            } else {
              console.error(xhr.statusText);
              alert(xhr.status + ': ' + xhr.statusText); // пример вывода: 404: Not Found
            }
          }
        };
        xhr.onerror = (e) => {
          console.error(xhr.statusText);
        };
        xhr.send(null);
      }



      function sendMessage() {
        // 1. Создаём новый объект XMLHttpRequest
        var xhr = new XMLHttpRequest();

        // 2. Конфигурируем его: GET-запрос на URL 'phones.json'
        let message = document.getElementById('sendText').value;
        let geo_link = document.getElementById('geo_link').innerText;
        let s_url = 'https://script.google.com/macros/s/AKfycbwWv1dF7vbr3RaIuJ9ucEQQfb1W_I1zhUSTmeL51XWCrZr_yrXYWTwVZon-f_ZneH8g/exec';
        // xhr.open('GET', s_url + '?text=' + message, false);
        // xhr.send();
        // xhr.open('GET', s_url + '?text=https://yandex.ru/maps/?text=' + geo_link, false);
        // xhr.send();
        fetch(s_url + '?text=' + message).then((response) => response.json()).then((json) => console.log(json));
        fetch(s_url + '?text=' + geo_link).then((response) => response.json()).then((json) => console.log(json));
        
        document.getElementById('sendResult').innerHTML += '<p><span class="badge badge-success badge-pill"> Отправлено <span class="badge badge-light badge-pill"><i class="fas fa-check"></i></span></span> <span class="badge badge-light badge-pill">' + message + '</span></p>';
        document.getElementById('sendText').value = '';
        console.log('receive_messages_flag='+receive_messages_flag);
        if (receive_messages_flag == 0) {
          console.log('receive_messages_flag='+receive_messages_flag+' -> 1');
          receive_messages_flag = 1;
          let timerId = setInterval(() => incMessage(), 3000);
        }

        // // 4. Если код ответа сервера не 200, то это ошибка
        // if (xhr.status != 200) {
        //   // обработать ошибку
        //   alert(xhr.status + ': ' + xhr.statusText); // пример вывода: 404: Not Found
        // } else {
        //   // вывести результат
        //   document.getElementById('sendResult').innerHTML += '<p><span class="badge badge-success badge-pill"> Отправлено <span class="badge badge-light badge-pill"><i class="fas fa-check"></i></span></span> <span class="badge badge-light badge-pill">' + message + '</span></p>';
        //   document.getElementById('sendText').value = '';

        //   //слушаем ответ
        //   // повторить с интервалом 3 секунды
        //   let timerId = setInterval(() => incMessage(), 3000);


        //   //alert( xhr.responseText ); // responseText -- текст ответа.
        // }
      }

      function autocall() {
        //263858@sip.comtube.com
        var newWindow = window.open('http://call2sip.ru/#680244@ruvoip.net', this.target, 'width=240,height=200,status=no,toolbar=no,menubar=no');
        return false;
      }
    //   document.addEventListener("DOMContentLoaded", incMessage);
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
      integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
      crossorigin="anonymous"></script>

    <script>


      navigator.geolocation.getCurrentPosition(function (position) {

        // Текущие координаты.
        var lat = position.coords.latitude;
        var lng = position.coords.longitude;
        var geo_link = 'https://yandex.ru/maps/?text=' + lat + '%2C' + lng + '&z=15';
        console.log(position.coords);
        document.getElementById('geo_link').innerHTML = geo_link;
        document.getElementById('test').innerHTML = '<a target="_blank" href="' + geo_link + '">geo</a>';
        document.getElementById('btn_video').href = "peer/index.html?geo_link=" + position.coords.latitude + "," + position.coords.longitude + "&start=1"
        document.getElementById('btn_video2').href = "peer/index.html?geo_link=" + position.coords.latitude + "," + position.coords.longitude + "&start=1"
      });
    </script>
</body>

</html>
